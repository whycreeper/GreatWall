// SPDX-License-Identifier: MIT

#ifndef PYLON_H
#define PYLON_H

#include "field.h"
#include "params.h"
#include <stdint.h>


static const GF constants[PYLON_NUM_INPUT_SBOX] =
{
  {0xe3ab045d4dc618df, 0x863be2d5afbd2660},
  {0xed6a9bd6559895e6, 0xf62da7df61364462},
  {0xff224f050322b7df, 0x778112d751891012}
};
#define GF_exp_invmer_e_3 GREATWALL_NAMESPACE(GF_exp_invmer_e_3)
void GF_exp_invmer_e_3(GF out, const GF in);

static const GF m1_transposed[128] = 
{{0x52ca12101430d1a6,0x4887f472a8283f1b},
{0xdb98babdc41cc4f,0xfbd84b391d100f15},
{0x8f6d1638fb3d127a,0x13a6cf6f01a15b89},
{0xe908f8805089e835,0x349626f6fe8e7745},
{0xf8d53e2f118187d2,0xbd911341c17b9bee},
{0xca822bc96a3f6022,0x539e70dc8e5069bf},
{0x1bad264fcad9e95d,0x61c883c63e919381},
{0xa728dc4477a40142,0x682968570df4392f},
{0x29defbc3dc899ba9,0x24b8671ad06f1d46},
{0xb01030663eb13315,0x6b8225dd53798b8b},
{0xe4fc11ea265a342b,0x3e58e259576c0f4c},
{0x8d7e3b4e0bc672b7,0xa3c95abae9218b12},
{0xee21b4d021abf0de,0x8992ba8f6aab25ae},
{0x75636c0689f7ddb,0xbc5425643efe1fe0},
{0x9897403d7a1f147c,0xa30c64eabba53540},
{0x68a73dac55ce0baa,0xdb02359692a49fc1},
{0x29f0fc9bf57c64a4,0x26402bb7147c4451},
{0xb6bccbba610e7329,0x7929c92dad5dfa31},
{0x7b1d9c296a392748,0x7c43ef46ee3c109f},
{0x5e3debbb28c322d9,0x6f11524255b5ec00},
{0x94e855516ece257a,0xc2d3949901ff8ed},
{0x1bfd53a842eb2bd5,0xf3b4ae6d849dcaf2},
{0x931e5ec25306f518,0x8a60c99609e40a19},
{0xa4b7758738ae1da0,0x5942e4a3663d3e77},
{0x2f53aa01cdab2c82,0x3c96fd30e8e8d240},
{0xe7d45d60b33019,0x615723a639afe914},
{0xd6ab00c05ebea589,0xb4b7da406a9398d0},
{0xc7a00e3cc2d86d37,0x8c3351d32819d416},
{0x1b6910900406e0f7,0x8abff480d7f44136},
{0x4e78f4ef15a2f4ec,0xdbb610f2631ed002},
{0xbece66de70f4de70,0x40dfb7416328114d},
{0x6e68a3ee865ab82,0xb0ed87389c8ec094},
{0x1edd1039f2ab5c8a,0x85a87a7c346c9ce1},
{0x918783e2adeb35c7,0x9175525c72b3056e},
{0x1f23070b1433030,0x4724633eb882670a},
{0xe3c08fd6c91e66b5,0xc87007b4212b3f4d},
{0x121935300c85e6f3,0x4570067485f79696},
{0x35e9b24a5dbc3b7b,0x5aaf87037ba65c5e},
{0xc34b937e3ca7b053,0x77ded04fecd50a0b},
{0xffb27f8e701e6a4f,0x56fae0ac139f9589},
{0x51b3e1c1de527786,0x4f54557a6395d0e3},
{0x8a2e04ccddb86f3,0x5d8469d26150053},
{0xbadfcef4a5140615,0x8bd9051c1731c0e0},
{0xcfceb06292696124,0x9695e984bdd073bc},
{0x7ca2a77130416b1e,0x4178b64c7e326b20},
{0x371d92b12b2f1c2a,0x908a9cdac5cc1023},
{0x2f52e53174c8de4c,0xde0c30b4b3892b76},
{0x2e5beea6c4969617,0xd83431fff1c74acb},
{0x3f601a7064cc3851,0x758ff81a3892b54f},
{0x8fd77315c4d60866,0x8198cc7a75361a3e},
{0xd797a177d57fe1f7,0x9cab5defd3d2124a},
{0xc765fc633fdb8ebd,0x45c9c327c08b06a4},
{0xe187093e801deaa5,0xb8236b099144e9e8},
{0x6317c396c6243a35,0x5669dd27244fdec0},
{0x8315ce3e28be9ab,0x1216788e54c33dda},
{0x29fea2de9dd15d7c,0xe4fab8e6a791c492},
{0x7e2fddf96c94fbef,0xc26739bd4e072dbb},
{0x9cd48da26f4fac6e,0x4b320f6bb1e417e0},
{0x7b62b906bc53f2d6,0xe1130a178be91a3a},
{0x2b1597f0bd96a8a7,0xb283f7c3d9af8a80},
{0x2455c55edd34f30f,0x8ff7686713accdd5},
{0x870800136694e2c8,0xc1edc6f2a1eb4324},
{0xd5a45abf1ee46afe,0x630c451b0a8638be},
{0x6ab937d17325df8b,0xa357dd38f23d9605},
{0x5902d5b666edbf24,0x5787e7eea7065972},
{0xd0cb359bdebff3f1,0x8b248759c425173e},
{0xb377f390f15d361e,0x6cf877b862d9d17a},
{0x135046e326d1f19,0x637d2a7d1e02ddb6},
{0xfb99de41b27db29c,0xea8e92744d3b1734},
{0x2a2187bde0cfc48b,0xb6ec166b93fc19db},
{0x23e54bfc8a23f62f,0x3134840efba743b5},
{0x1073aa582c5fa279,0x952055fa48f98408},
{0xb83753356341e13a,0x93fdc1f9cc88e1c0},
{0xaa550e51acab605d,0x29427b8f148ea4a9},
{0x38093e7deafeb90a,0xbc02d43b7c54b597},
{0xf44982b8f5e2d88b,0xeebeae34e8c44726},
{0x77a74ad3e5a0480e,0x3ecfbb032a8e6427},
{0xfdc0ba063f3a4828,0xdac3f218c1888e54},
{0x337578f917eaecb9,0xf31c7061212c0a35},
{0xfc463be8e3c5ea1f,0x51e1a6c74f863b74},
{0x8c6925972c06bb74,0x74f017b170d2beef},
{0xce64a821648839c8,0x5ef9d960e871920e},
{0x11b7cbeeae528226,0x7be486b6a8c190eb},
{0x1c134663fd8e1fa,0xa72c17a4c1bc9941},
{0x9c85e2c440010fe2,0xc4dc19ce07fe5baa},
{0xf96cf888989fc323,0x775652deab4f23c5},
{0x41cda12116101d28,0xd47b572641287134},
{0xc0054d1b484d7ecf,0x22b9fa7a0c95c8b7},
{0x150a37ccfda3951f,0x6b301d95d95cc283},
{0x8a6219270aa1d268,0x1491d42dd71274cc},
{0xdc371b425806ad8d,0xdfdfcfaeb987beb9},
{0x12cc0c49ace42eb2,0x247e9360e0e7468e},
{0x7192736609af1ec9,0x7240030af1444bc7},
{0xee131f089c22d003,0xa0a7d361225e9530},
{0x2b4fbdb73dcf1c0b,0x9c02613a073766e7},
{0x7c938b715e29d058,0x96dadcf929c3775c},
{0xaccac5644274d8fc,0xfdc1da8a1c535484},
{0x59eb08315cefce0a,0xa1e947e30e684fe4},
{0xed36949c09ac2dd5,0xd6258f415535dc},
{0xde78d79ed50a0e7c,0xd64cd544d96e6f19},
{0x2f0414d81f66830c,0x1dd8c421b5cbaf62},
{0x54231fb6ffeb1c78,0x5d8cb5e92d26eae1},
{0x502ef6acf7b8c8a9,0xfd82c5700b2d40e6},
{0x641f5ef5c8965b65,0xfa8ac6504427fbfe},
{0xee16850d465556e,0xa223fda488edf337},
{0x8f682ba89a29d7cf,0x9bbf6bdb7accf8d7},
{0x64dd242977ec6b21,0x3ae04374d5cb6e46},
{0x19fbac3016ef22ac,0x5eee16e2fe70341b},
{0xa872a7d51e12d95e,0xe417c17ff97e0466},
{0x27adc0184a6f43e4,0x49491db23623ad0c},
{0xed9b1c108fa20c65,0x926f45f482aebf8c},
{0x47082105b17b9bfb,0xee514bcee85f96a6},
{0x945bdc36867cf1db,0xa1d911329e416c1f},
{0x59dc89d1c32ccfd5,0x52220079fef4555b},
{0x8c3d83b4cc89895a,0xcb5630e1fb80bf7f},
{0x59975fb02e764870,0xad593cb38a54bc35},
{0x7644755512b66feb,0x47130de19993e4fc},
{0x39a2af6479947b5a,0x4eae7004eaed36a0},
{0x9535163c9c3985ae,0xe5d6b1254b83c4ff},
{0xc2237cdbb7421e83,0xa34e65037474a53c},
{0x8c34f6d849588af0,0x3b067cd6ba7af1bd},
{0xd76b1c16fa6215aa,0xcc5d091b88d378b5},
{0x4847661128ed4033,0xba6187cf847e5e74},
{0xe16ab8d09f089cf9,0x3a09c37d065649d},
{0xe37342396737728d,0x33647b76f84914b},
{0xe20760e9b6a17b8f,0xa65f6d47d42eb76e},
{0x79d5f3825d4f83cf,0x89600756ed5e882f},
{0xa187d8089e4a09fe,0x174caa76dd79e3e2}
};
static const GF m2_transposed[128] = {{0x1aa177f6bb610cbb,0xc0a5aaeee6655f1a},
{0x8a4f6a33813dd3fd,0xdea019397f2626a6},
{0x389b48d886b22b45,0xdf265206c3c80303},
{0x7b391e33d82a9b9b,0xab0e7b60f8ed4845},
{0x64ff34981c28e2f6,0x99e94a49663487a6},
{0xcded6c2792da50de,0xd6df7d0ea78d7aa9},
{0xbc1904d7376f24f9,0x4993a85a3922abc3},
{0x1b6601a77e076357,0xa6e9e428071e42f},
{0x25f6526882c4bfc4,0xd935bda53623661f},
{0xa8ca464140649182,0xb62f330759703a38},
{0x99add5db1e11ccdb,0x372f7d63fbf97c35},
{0xfba5c5f47690de85,0xd7b8f8c2e4d06137},
{0xcd2a0e2bc900458e,0x2ceda2cc1bdd9aa3},
{0x9f265d7d16b4956d,0x9c39ecf6cd713468},
{0x185e0fb1e6b8bfa2,0x2e87180790d6d8ce},
{0xddf87aa6e0ce2723,0x657b37a1be24d653},
{0xfa97e7f34f43f3b1,0xc557704d4245ca6},
{0xc55e3d467112c5db,0xbfd964d5b2ea691a},
{0x9eaa38538ac69f1f,0x3bd738eb57aaf116},
{0x2342d6130b275bf7,0x72f714bb0aba851e},
{0xdfef3c1b9860ab6f,0x37fc849f119a2444},
{0x3f268c452df66a13,0x8fad07f4fe86244f},
{0x9350c4e9c742582a,0xfe12e64101830d54},
{0xed9ef9bf23855154,0xce9a809aefd4ea4b},
{0xfcac538409baed9a,0x12eaf0625a1ce85f},
{0xbeeb82e87ca4e9a8,0x36f56ad563564a14},
{0x67f18f737248685b,0x81332b811768c123},
{0x4d616f2fd1e67262,0xa336c05c3801ef77},
{0x78ae4ce4dbe63cd,0xefdc5341879afc7a},
{0x21d95e6a5882a9ce,0xffe0b5897c89f7a5},
{0xf2708f1577d1a861,0xde67534e665748e8},
{0xd4dfb0f813c5c09e,0xdfe8e955b20eddf9},
{0x177c5a9a7395cb35,0x218ae593f386057f},
{0xccb9a66284887036,0x945053cd7ce90f59},
{0x3c415f433caabd6b,0x357aa9d5dd286a6},
{0x461887e8330b6639,0x95c876260093de39},
{0x6d070d3d93b1c80d,0x5bd407bea5443734},
{0xb48ed108177e0373,0x478ce90261e2f91a},
{0xe78a6e6255fcf52b,0x7e2e0a87bf6e267e},
{0x72ed3683a49b78d2,0xe9d5de5397537e07},
{0xab5650fd922a2db8,0xc9e3725e582fe64a},
{0x82af2edaf4c00297,0xa38f4b5361a29c83},
{0x749c692a94a345e6,0x75111c77bfe7daa8},
{0x6d3538cf810eb4a2,0x4dd6924d53f2b71e},
{0x2be46229209c50d,0x83fa252f5558dfc1},
{0x5162950e1244f35b,0x2967234cf8600bf0},
{0x56977825b6e1c356,0x5e0fb44edcadf633},
{0x96009c67a282f081,0xf9896e5ea2038c4f},
{0xef9d794e7df17fab,0xb69dd236928bb44a},
{0x1968df81676e42e0,0x5bf7bb98ecddf541},
{0x76f3adb32b38bc98,0x5e5e4efc547c9c70},
{0x2b8af67f98a650f6,0xf3159a58879f544f},
{0x46874df3d934aa52,0x1d2d1192c5e36f35},
{0x9089fe51b6ff9a01,0xa6b3da476904195f},
{0xb933d0cbc1b39204,0x7b2edd3139bb1273},
{0x5a4ee5d4d7fae43f,0xca74f4490b84d58b},
{0xc585582a94e49d92,0x3aaa3a0e8047b63c},
{0x4488b27fc748448c,0xbd5c1622ead8eaa},
{0x5bb6ade532b1b8db,0x285981bfb9494c49},
{0x462914d3ad5c6368,0xe72da82716e83bc8},
{0xe1e20fce24dfeccc,0xbafa96e316e79823},
{0x4a6862b7f5c06b57,0x9fd816e0a624c969},
{0x1ad6abc6fca938bd,0x5e7c7d12932ef22f},
{0x907b7dccadd0d61f,0x49199e98dc7cbda},
{0xb9eebca5c062f91c,0x1a3d1eb9bb1e254a},
{0xc81f597bbfbd72ff,0x8bae2edb9f36c74d},
{0xcd66a71b0dfd9120,0x3d87c1f41b8f6817},
{0x43eff0d3e8fec286,0x1f61eba3cb67cc28},
{0xd26ee16bd0c7a75,0x90084d9486f3ede9},
{0x8bc5457738da5e57,0xbc547422b8ad9f54},
{0x2352564c7e77dd72,0x44ab793a83595490},
{0xf7f2f9adab0b5b21,0x718bd945705e93e9},
{0x25e46b26f7febea6,0x4722ed54beb212cb},
{0xccdf3c851c402d94,0x473164699100507f},
{0xaaacbcae17d9274e,0x4a89434a31488a8d},
{0x6a138f432d46d33b,0xff3965f0b88ac54},
{0x19921a3e74f2d7f7,0x531c26e89a26c3ca},
{0x26934dc88190bdc6,0x9eafb2448c1b60f5},
{0x28408212ba1ee809,0x8b5858e122bc93ac},
{0xae3744a15d628755,0x81e5b63834f32826},
{0x3ad430988babe3b4,0xcfb06c876218faa5},
{0xcbf4c8b0cd8b3c01,0x4482121ce2e9fb66},
{0xaca670cd7dc701c5,0x106ac2e7a9e4ec87},
{0x371a79d997e03c7a,0xac5e63a57a108b77},
{0x96199998a1aff383,0x1ef8271ba3411b},
{0xd6affb5f7b3e4408,0x47ad06fa1ab161d9},
{0xe2b27943109f7559,0xc325f1c5504bf61d},
{0xf9ec2d8693797efa,0xabfd119b9f8e5dde},
{0x8a7bb7b997508254,0x1bbb1a0d26decb98},
{0x81c5a1418edd483e,0x257fc1475dcb9d42},
{0x546d49e35357350d,0x6dbfc08907f994dc},
{0x13c5a528c937f492,0x3cb7ddabf210e7d2},
{0xc8c805c6f8165d6e,0xfeb9a78c2065cf9d},
{0x352ed392c7aa5478,0xe5f0fa17eae8f75a},
{0x925b05b4f003ad6a,0xfdd1c4fd57323671},
{0xa35819c9de22ba6f,0x4cb6b412c03af192},
{0xc9347b06c4197d7d,0x6e5b199b702733fc},
{0xc38a68931b93b412,0xe44782f62fb43e08},
{0x84e726bbc92173e6,0xa797697b7b3d847f},
{0x1688538e9799687b,0x354838a122013533},
{0x53e1650655970fc3,0x80d28b56a2f41d82},
{0x27a325c9cdf4b258,0x2e2af4a7d061ff01},
{0xc0b742f6014de9e1,0x211d65349cfa72e5},
{0x3ea4f7cbdf40f286,0xc7493eb38b9c364a},
{0xab9a7badc2ea621e,0x2c2816700209aa55},
{0x4de49d194ecad2a8,0x772d9dafd87f019},
{0x2fbfe77cc023d11c,0x49b4ec65b5059a7d},
{0xa33d4f2dcc923553,0xc99203b30ae70c31},
{0x75aa2aa53f6cf3c7,0xbc3b97e32e4d3d7b},
{0x59f8e3241b292a50,0x6783c62adaa4c5cb},
{0x4f2376329197ab94,0xa4d78e5f0a8297d4},
{0x4af8483fd6362e50,0xf0c134279dab1b8b},
{0xb393ae51137cd6a8,0x8330f46eb50b5d11},
{0xd0ce8be434dfc83,0x5c804e09e25c902},
{0xecbfb02c0aeef42a,0x86aa08830af2c78d},
{0x2fd7273eb405de13,0x8a7e5e9a2457a0c1},
{0xa3d9fcd105fb2cbc,0x5ef9619103811990},
{0x82493ed7b48a47a7,0xb15cea0694007d95},
{0xca4316a20c287ecb,0x37be2d24da0d5f2b},
{0x95ee1117d85aa6d9,0x87d6a36f3ae3562c},
{0xbebf6751f18e4e21,0x8cabfeed43aa096c},
{0xca2c41ffe5c872be,0xa3d18c91430e6e02},
{0x15814b4ad5bc744,0xace04537d1166e65},
{0xdc14e90497f5cb4d,0x4db7643475fb8eab},
{0xadd3d9f5300385d8,0xd7c4fad79b6a7ad5},
{0xc7b7cfb3a2ebbe89,0xe7fe7193595c8cd8},
{0xbff521521142a7db,0x74a3c7fdba4bda7b},
{0x87bf552e1af1f84d,0x3d996c24af89b2f8}};

#define pylon_2_sbox_outputs GREATWALL_NAMESPACE(pylon_2_sbox_outputs)
void pylon_2_sbox_outputs(GF sbox_outputs[PYLON_NUM_INPUT_Matrix + 1], const GF pt);

#define pylon GREATWALL_NAMESPACE(pylon)
void pylon(uint8_t ct[PYLON_NUM_BYTES_FIELD],
          const uint8_t pt[PYLON_NUM_BYTES_FIELD]);

#endif // PYLON_H
